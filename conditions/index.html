<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="None">
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Benthos</title>
        <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body class="homepage">

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="..">Benthos</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li >
                                <a href="/">Home</a>
                            </li>
                            <li >
                                <a href="../concepts/">Concepts</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Components <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../inputs">Inputs</a>
</li>
                                    
<li >
    <a href="../buffers">Buffers</a>
</li>
                                    
<li >
    <a href="../processors">Processors</a>
</li>
                                    
<li >
    <a href=".">Conditions</a>
</li>
                                    
<li >
    <a href="../outputs">Outputs</a>
</li>
                                    
<li >
    <a href="../caches">Caches</a>
</li>
                                    
<li >
    <a href="../rate_limits">Rate Limits</a>
</li>
                                    
<li >
    <a href="../metrics">Metrics</a>
</li>
                                    
<li >
    <a href="../tracers">Tracers</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Guides <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../getting_started/">Getting Started</a>
</li>
                                    
<li >
    <a href="../pipeline/">Pipeline</a>
</li>
                                    
<li >
    <a href="../batching/">Message Batching</a>
</li>
                                    
<li >
    <a href="../error_handling/">Error Handling</a>
</li>
                                    
<li >
    <a href="../workflows/">Workflows</a>
</li>
                                    
<li >
    <a href="../configuration/">Config Cheats</a>
</li>
                                    
<li >
    <a href="../config_interpolation/">Config Interpolation</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#conditions">Conditions</a></li>
            <li><a href="#batching-and-multipart-messages">Batching and Multipart Messages</a></li>
            <li><a href="#reusing-conditions">Reusing Conditions</a></li>
            <li><a href="#contents">Contents</a></li>
            <li><a href="#and">and</a></li>
            <li><a href="#bounds_check">bounds_check</a></li>
            <li><a href="#check_field">check_field</a></li>
            <li><a href="#count">count</a></li>
            <li><a href="#jmespath">jmespath</a></li>
            <li><a href="#metadata">metadata</a></li>
            <li><a href="#not">not</a></li>
            <li><a href="#or">or</a></li>
            <li><a href="#processor_failed">processor_failed</a></li>
            <li><a href="#resource">resource</a></li>
            <li><a href="#static">static</a></li>
            <li><a href="#text">text</a></li>
            <li><a href="#xor">xor</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="conditions">Conditions</h1>
<p>This document was generated with <code>benthos --list-conditions</code></p>
<p>Conditions are boolean queries that can be executed based on the contents of a
message. Some <a href="../processors/">processors</a> such as <a href="../processors/#filter"><code>filter</code></a> use
conditions for expressing their logic.</p>
<p>Conditions themselves can modify (<code>not</code>) and combine (<code>and</code>, <code>or</code>)
other conditions, and can therefore be used to create complex boolean
expressions.</p>
<p>The format of a condition is similar to other Benthos types:</p>
<pre><code class="yaml">condition:
  type: text
  text:
    operator: equals
    part: 0
    arg: hello world
</code></pre>

<p>And using boolean condition types we can combine multiple conditions together:</p>
<pre><code class="yaml">condition:
  type: and
  and:
  - type: text
    text:
      operator: contains
      arg: hello world
  - type: or
    or:
    - type: text
      text:
        operator: contains
        arg: foo
    - type: not
      not:
        type: text
        text:
          operator: contains
          arg: bar
</code></pre>

<p>The above example could be summarised as 'text contains "hello world" and also
either contains "foo" or does <em>not</em> contain "bar"'.</p>
<p>Conditions can be extremely useful for creating filters on an output. By using a
fan out output broker with 'filter' processors on the brokered outputs it is
possible to build
<a href="../concepts/#content-based-multiplexing">curated data streams</a> that filter on
the content of each message.</p>
<h3 id="batching-and-multipart-messages">Batching and Multipart Messages</h3>
<p>All conditions can be applied to a multipart message, which is synonymous with a
batch. Some conditions target a specific part of a message batch, and require
you specify the target index with the field <code>part</code>.</p>
<p>Some processors such as <a href="../processors/#filter"><code>filter</code></a> apply its conditions across
the whole batch. Whereas other processors such as
 <a href="../processors/#filter_parts"><code>filter_parts</code></a> will apply its conditions on each part
of a batch individually, in which case the condition acts as if it were
referencing a single message batch.</p>
<p>Part indexes can be negative, and if so the part will be selected from the end
counting backwards starting from -1. E.g. if part = -1 then the selected part
will be the last part of the message, if part = -2 then the part before the last
element with be selected, and so on.</p>
<h3 id="reusing-conditions">Reusing Conditions</h3>
<p>Sometimes large chunks of logic are reused across processors, or nested multiple
times as branches of a larger condition. It is possible to avoid writing
duplicate condition configs by using the <a href="#resource">resource condition</a>.</p>
<h3 id="contents">Contents</h3>
<ol>
<li><a href="#and"><code>and</code></a></li>
<li><a href="#bounds_check"><code>bounds_check</code></a></li>
<li><a href="#check_field"><code>check_field</code></a></li>
<li><a href="#count"><code>count</code></a></li>
<li><a href="#jmespath"><code>jmespath</code></a></li>
<li><a href="#metadata"><code>metadata</code></a></li>
<li><a href="#not"><code>not</code></a></li>
<li><a href="#or"><code>or</code></a></li>
<li><a href="#processor_failed"><code>processor_failed</code></a></li>
<li><a href="#resource"><code>resource</code></a></li>
<li><a href="#static"><code>static</code></a></li>
<li><a href="#text"><code>text</code></a></li>
<li><a href="#xor"><code>xor</code></a></li>
</ol>
<h2 id="and"><code>and</code></h2>
<pre><code class="yaml">type: and
and: []
</code></pre>

<p>And is a condition that returns the logical AND of its children conditions.</p>
<h2 id="bounds_check"><code>bounds_check</code></h2>
<pre><code class="yaml">type: bounds_check
bounds_check:
  max_part_size: 1.073741824e+09
  max_parts: 100
  min_part_size: 1
  min_parts: 1
</code></pre>

<p>Checks a message against a set of bounds.</p>
<h2 id="check_field"><code>check_field</code></h2>
<pre><code class="yaml">type: check_field
check_field:
  condition: {}
  parts: []
  path: &quot;&quot;
</code></pre>

<p>Extracts the value of a field within messages (currently only JSON format is
supported) and then tests the extracted value against a child condition.</p>
<h2 id="count"><code>count</code></h2>
<pre><code class="yaml">type: count
count:
  arg: 100
</code></pre>

<p>Counts messages starting from one, returning true until the counter reaches its
target, at which point it will return false and reset the counter. This
condition is useful when paired with the <code>read_until</code> input, as it can
be used to cut the input stream off once a certain number of messages have been
read.</p>
<p>It is worth noting that each discrete count condition will have its own counter.
Parallel processors containing a count condition will therefore count
independently. It is, however, possible to share the counter across processor
pipelines by defining the count condition as a resource.</p>
<h2 id="jmespath"><code>jmespath</code></h2>
<pre><code class="yaml">type: jmespath
jmespath:
  part: 0
  query: &quot;&quot;
</code></pre>

<p>Parses a message part as a JSON blob and attempts to apply a JMESPath expression
to it, expecting a boolean response. If the response is true the condition
passes, otherwise it does not. Please refer to the
<a href="http://jmespath.org/">JMESPath website</a> for information and tutorials regarding
the syntax of expressions.</p>
<p>For example, with the following config:</p>
<pre><code class="yaml">jmespath:
  part: 0
  query: a == 'foo'
</code></pre>

<p>If the initial jmespaths of part 0 were:</p>
<pre><code class="json">{
    &quot;a&quot;: &quot;foo&quot;
}
</code></pre>

<p>Then the condition would pass.</p>
<p>JMESPath is traditionally used for mutating JSON, in order to do this please
instead use the <a href="../processors/#jmespath"><code>jmespath</code></a>
processor.</p>
<h2 id="metadata"><code>metadata</code></h2>
<pre><code class="yaml">type: metadata
metadata:
  arg: &quot;&quot;
  key: &quot;&quot;
  operator: equals_cs
  part: 0
</code></pre>

<p>Metadata is a condition that checks metadata keys of a message part against an
operator from the following list:</p>
<h3 id="enum"><code>enum</code></h3>
<p>Checks whether the contents of a metadata key matches one of the defined enum
values.</p>
<pre><code class="yaml">type: metadata
metadata:
  operator: enum
  part: 0
  key: foo
  arg:
    - bar
    - baz
    - qux
    - quux
</code></pre>

<h3 id="equals"><code>equals</code></h3>
<p>Checks whether the contents of a metadata key matches an argument. This operator
is case insensitive.</p>
<pre><code class="yaml">type: metadata
metadata:
  operator: equals
  part: 0
  key: foo
  arg: bar
</code></pre>

<h3 id="equals_cs"><code>equals_cs</code></h3>
<p>Checks whether the contents of a metadata key matches an argument. This operator
is case sensitive.</p>
<pre><code class="yaml">type: metadata
metadata:
  operator: equals_cs
  part: 0
  key: foo
  arg: BAR
</code></pre>

<h3 id="exists"><code>exists</code></h3>
<p>Checks whether a metadata key exists.</p>
<pre><code class="yaml">type: metadata
metadata:
  operator: exists
  part: 0
  key: foo
</code></pre>

<h3 id="greater_than"><code>greater_than</code></h3>
<p>Checks whether the contents of a metadata key, parsed as a floating point
number, is greater than an argument. Returns false if the metadata value cannot
be parsed into a number.</p>
<pre><code class="yaml">type: metadata
metadata:
  operator: greater_than
  part: 0
  key: foo
  arg: 3
</code></pre>

<h3 id="has_prefix"><code>has_prefix</code></h3>
<p>Checks whether the contents of a metadata key match one of the provided prefixes.
The arg field can either be a singular prefix string or a list of prefixes.</p>
<pre><code class="yaml">type: metadata
metadata:
  operator: has_prefix
  part: 0
  key: foo
  arg:
    - foo
    - bar
    - baz
</code></pre>

<h3 id="less_than"><code>less_than</code></h3>
<p>Checks whether the contents of a metadata key, parsed as a floating point
number, is less than an argument. Returns false if the metadata value cannot be
parsed into a number.</p>
<pre><code class="yaml">type: metadata
metadata:
  operator: less_than
  part: 0
  key: foo
  arg: 3
</code></pre>

<h3 id="regexp_partial"><code>regexp_partial</code></h3>
<p>Checks whether any section of the contents of a metadata key matches a regular
expression (RE2 syntax).</p>
<pre><code class="yaml">type: metadata
metadata:
  operator: regexp_partial
  part: 0
  key: foo
  arg: &quot;1[a-z]2&quot;
</code></pre>

<h3 id="regexp_exact"><code>regexp_exact</code></h3>
<p>Checks whether the contents of a metadata key exactly matches a regular expression 
(RE2 syntax).</p>
<pre><code class="yaml">type: metadata
metadata:
  operator: regexp_partial
  part: 0
  key: foo
  arg: &quot;1[a-z]2&quot;
</code></pre>

<h2 id="not"><code>not</code></h2>
<pre><code class="yaml">type: not
not: {}
</code></pre>

<p>Not is a condition that returns the opposite (NOT) of its child condition. The
body of a not object is the child condition, i.e. in order to express 'part 0
NOT equal to "foo"' you could have the following YAML config:</p>
<pre><code class="yaml">type: not
not:
  type: text
  text:
    operator: equal
    part: 0
    arg: foo
</code></pre>

<p>Or, the same example as JSON:</p>
<pre><code class="json">{
    &quot;type&quot;: &quot;not&quot;,
    &quot;not&quot;: {
        &quot;type&quot;: &quot;text&quot;,
        &quot;text&quot;: {
            &quot;operator&quot;: &quot;equal&quot;,
            &quot;part&quot;: 0,
            &quot;arg&quot;: &quot;foo&quot;
        }
    }
}
</code></pre>

<h2 id="or"><code>or</code></h2>
<pre><code class="yaml">type: or
or: []
</code></pre>

<p>Or is a condition that returns the logical OR of its children conditions.</p>
<h2 id="processor_failed"><code>processor_failed</code></h2>
<pre><code class="yaml">type: processor_failed
processor_failed:
  part: 0
</code></pre>

<p>Returns true if a processing stage of a message has failed. This condition is
useful for dropping failed messages or creating dead letter queues, you can read
more about these patterns <a href="../error_handling/">here</a>.</p>
<h2 id="resource"><code>resource</code></h2>
<pre><code class="yaml">type: resource
resource: &quot;&quot;
</code></pre>

<p>Resource is a condition type that runs a condition resource by its name. This
condition allows you to run the same configured condition resource in multiple
processors, or as a branch of another condition.</p>
<p>For example, let's imagine we have two outputs, one of which only receives
messages that satisfy a condition and the other receives the logical NOT of that
same condition. In this example we can save ourselves the trouble of configuring
the same condition twice by referring to it as a resource, like this:</p>
<pre><code class="yaml">output:
  type: broker
  broker:
    pattern: fan_out
    outputs:
    - type: foo
      foo:
        processors:
        - type: filter
          filter:
            type: resource
            resource: foobar
    - type: bar
      bar:
        processors:
        - type: filter
          filter:
            type: not
            not:
              type: resource
              resource: foobar
resources:
  conditions:
    foobar:
      type: text
      text:
        operator: equals_cs
        part: 1
        arg: filter me please
</code></pre>

<h2 id="static"><code>static</code></h2>
<pre><code class="yaml">type: static
static: true
</code></pre>

<p>Static is a condition that always resolves to the same static boolean value.</p>
<h2 id="text"><code>text</code></h2>
<pre><code class="yaml">type: text
text:
  arg: &quot;&quot;
  operator: equals_cs
  part: 0
</code></pre>

<p>Text is a condition that checks the contents of a message part as plain text
against a logical operator and an argument.</p>
<p>Available logical operators are:</p>
<h3 id="equals_cs_1"><code>equals_cs</code></h3>
<p>Checks whether the part equals the argument (case sensitive.)</p>
<h3 id="equals_1"><code>equals</code></h3>
<p>Checks whether the part equals the argument under unicode case-folding (case
insensitive.)</p>
<h3 id="contains_cs"><code>contains_cs</code></h3>
<p>Checks whether the part contains the argument (case sensitive.)</p>
<h3 id="contains"><code>contains</code></h3>
<p>Checks whether the part contains the argument under unicode case-folding (case
insensitive.)</p>
<h3 id="prefix_cs"><code>prefix_cs</code></h3>
<p>Checks whether the part begins with the argument (case sensitive.)</p>
<h3 id="prefix"><code>prefix</code></h3>
<p>Checks whether the part begins with the argument under unicode case-folding
(case insensitive.)</p>
<h3 id="suffix_cs"><code>suffix_cs</code></h3>
<p>Checks whether the part ends with the argument (case sensitive.)</p>
<h3 id="suffix"><code>suffix</code></h3>
<p>Checks whether the part ends with the argument under unicode case-folding (case
insensitive.)</p>
<h3 id="regexp_partial_1"><code>regexp_partial</code></h3>
<p>Checks whether any section of the message part matches a regular expression (RE2
syntax).</p>
<h3 id="regexp_exact_1"><code>regexp_exact</code></h3>
<p>Checks whether the message part exactly matches a regular expression (RE2
syntax).</p>
<h2 id="xor"><code>xor</code></h2>
<pre><code class="yaml">type: xor
xor: []
</code></pre>

<p>Xor is a condition that returns the logical XOR of its children conditions,
meaning it only resolves to true if <em>exactly</em> one of its children conditions
resolves to true.</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "..",
                shortcuts = {"search": 83, "next": 78, "help": 191, "previous": 80};
        </script>
        <script src="../js/base.js" defer></script>
        <script src="../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>

<!--
MkDocs version : 1.0.4
Build Date UTC : 2019-03-08 14:21:22
-->
